<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manipal BFSI CMS</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; }
        .nav { background: rgba(255,255,255,0.95); backdrop-filter: blur(10px); box-shadow: 0 4px 20px rgba(0,0,0,0.1); position: sticky; top: 0; z-index: 1000; }
        .nav-container { max-width: 1600px; margin: 0 auto; padding: 0 20px; display: flex; justify-content: space-between; align-items: center; height: 70px; }
        .nav-logo { display: flex; align-items: center; gap: 12px; font-size: 24px; font-weight: bold; color: #2d3748; text-decoration: none; }
        .nav-links { display: flex; list-style: none; gap: 30px; }
        .nav-links a { color: #4a5568; text-decoration: none; font-weight: 500; padding: 8px 16px; border-radius: 8px; transition: all 0.3s; }
        .nav-links a:hover, .nav-links a.active { background: linear-gradient(135deg, #667eea, #764ba2); color: white; }
        .container { max-width: 1600px; margin: 0 auto; padding: 20px; }
        .section { display: none; }
        .section.active { display: block; }
        .hero { background: white; border-radius: 20px; padding: 60px 40px; text-align: center; box-shadow: 0 15px 35px rgba(0,0,0,0.1); margin-bottom: 40px; }
        .hero-title { font-size: 48px; margin-bottom: 20px; background: linear-gradient(135deg, #667eea, #764ba2); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .hero-subtitle { font-size: 24px; color: #4a5568; margin-bottom: 30px; }
        .hero-desc { font-size: 18px; color: #666; margin-bottom: 40px; max-width: 800px; margin-left: auto; margin-right: auto; }
        .btn { padding: 15px 30px; border: none; border-radius: 10px; font-size: 16px; font-weight: 600; cursor: pointer; transition: all 0.3s; display: inline-flex; align-items: center; gap: 10px; text-decoration: none; }
        .btn-primary { background: linear-gradient(135deg, #667eea, #764ba2); color: white; }
        .btn-secondary { background: white; color: #667eea; border: 2px solid #667eea; }
        .btn-success { background: linear-gradient(135deg, #48bb78, #38a169); color: white; }
        .btn-warning { background: linear-gradient(135deg, #ed8936, #dd6b20); color: white; }
        .btn-danger { background: linear-gradient(135deg, #e53e3e, #c53030); color: white; }
        .btn:hover { transform: translateY(-3px); box-shadow: 0 8px 25px rgba(0,0,0,0.2); }
        .btn-small { padding: 8px 16px; font-size: 14px; }
        .features { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 30px; }
        .feature-card { background: white; padding: 30px; border-radius: 15px; box-shadow: 0 8px 25px rgba(0,0,0,0.1); text-align: center; }
        .feature-icon { font-size: 48px; margin-bottom: 20px; }
        .feature-title { font-size: 20px; margin-bottom: 15px; color: #2d3748; }
        .feature-desc { color: #666; line-height: 1.6; }
        .login-container { background: white; padding: 40px; border-radius: 20px; box-shadow: 0 15px 35px rgba(0,0,0,0.1); max-width: 400px; margin: 50px auto; text-align: center; }
        .form-group { margin-bottom: 20px; text-align: left; }
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; }
        label { display: block; margin-bottom: 8px; color: #4a5568; font-weight: 500; }
        input, select, textarea { width: 100%; padding: 12px 16px; border: 2px solid #e2e8f0; border-radius: 8px; font-size: 16px; }
        input:focus, select:focus, textarea:focus { outline: none; border-color: #667eea; }
        .header { background: white; padding: 20px; border-radius: 15px; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 8px 25px rgba(0,0,0,0.1); }
        .stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .stat-card { background: white; padding: 25px; border-radius: 15px; box-shadow: 0 8px 25px rgba(0,0,0,0.1); text-align: center; }
        .stat-icon { font-size: 36px; margin-bottom: 15px; }
        .stat-number { font-size: 28px; font-weight: bold; color: #2d3748; margin-bottom: 8px; }
        .stat-label { color: #666; font-size: 14px; text-transform: uppercase; }
        .main-content { display: grid; grid-template-columns: 2fr 1fr; gap: 20px; }
        .form-section, .sidebar-section { background: white; padding: 30px; border-radius: 15px; box-shadow: 0 8px 25px rgba(0,0,0,0.1); }
        .section-title { display: flex; align-items: center; gap: 10px; margin-bottom: 25px; color: #2d3748; font-size: 20px; font-weight: 600; }
        .request-card { border: 2px solid #e2e8f0; border-radius: 12px; padding: 20px; margin-bottom: 15px; transition: all 0.3s; }
        .request-card:hover { border-color: #667eea; box-shadow: 0 4px 12px rgba(0,0,0,0.1); }
        .request-card.urgent { border-color: #e53e3e; background: #fef5f5; }
        .request-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .request-id { font-weight: bold; color: #2d3748; }
        .priority-badge, .status-badge { padding: 4px 12px; border-radius: 12px; font-size: 12px; font-weight: 500; text-transform: uppercase; }
        .priority-high { background: #fed7d7; color: #c53030; }
        .priority-medium { background: #fef5e7; color: #b7791f; }
        .priority-low { background: #c6f6d5; color: #2f855a; }
        .status-pending { background: #fef5e7; color: #b7791f; }
        .status-approved { background: #c6f6d5; color: #2f855a; }
        .status-rejected { background: #fed7d7; color: #c53030; }
        .status-completed { background: #bee3f8; color: #2b6cb0; }
        .file-upload { border: 2px dashed #cbd5e0; border-radius: 8px; padding: 20px; text-align: center; cursor: pointer; transition: all 0.3s; }
        .file-upload:hover { border-color: #667eea; background-color: #f7fafc; }
        .file-item { display: flex; justify-content: space-between; align-items: center; padding: 8px 12px; background: #f7fafc; border-radius: 6px; margin-bottom: 5px; }
        .file-remove { color: #e53e3e; cursor: pointer; font-weight: bold; }
        .admin-panel { background: #f7fafc; padding: 20px; border-radius: 15px; margin-bottom: 20px; border: 2px solid #e2e8f0; }
        .admin-controls { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 20px; }
        .control-card { background: white; padding: 20px; border-radius: 10px; text-align: center; border: 2px solid #e2e8f0; cursor: pointer; transition: all 0.3s; }
        .control-card:hover { border-color: #667eea; transform: translateY(-2px); }
        .contact-list { display: flex; flex-direction: column; gap: 15px; }
        .contact-item { background: #f7fafc; padding: 20px; border-radius: 12px; border: 2px solid #e2e8f0; }
        .contact-info { display: flex; justify-content: space-between; align-items: center; }
        .contact-name { font-weight: 600; color: #2d3748; font-size: 18px; }
        .contact-phone { color: #667eea; font-weight: 500; }
        .message { padding: 10px; border-radius: 6px; margin-top: 15px; display: none; }
        .error { background: #fed7d7; color: #c53030; }
        .success { background: #c6f6d5; color: #2f855a; }
        @media (max-width: 768px) { .main-content, .form-row, .stats { grid-template-columns: 1fr; } .header { flex-direction: column; gap: 15px; } }
    </style>
</head>
<body>
    <nav class="nav">
        <div class="nav-container">
            <a href="#" class="nav-logo" onclick="showLanding()">üèõÔ∏è Manipal BFSI</a>
            <ul class="nav-links">
                <li><a href="#" onclick="showLanding()" id="nav-home">üè† Home</a></li>
                <li><a href="#" onclick="showLogin()" id="nav-cms">üìù CMS Portal</a></li>
                <li><a href="#" onclick="showContact()">üìû Contact</a></li>
            </ul>
        </div>
    </nav>

    <!-- Landing Section -->
    <div class="section active" id="landingSection">
        <div class="container">
            <div class="hero">
                <div class="hero-title">üèõÔ∏è Content Management System</div>
                <div class="hero-subtitle">Manipal BFSI Digital Platform</div>
                <div class="hero-desc">Streamline your content operations with our comprehensive management system. From request submission to final delivery, manage your entire content workflow with powerful role-based access controls.</div>
                <div style="display: flex; gap: 20px; justify-content: center; flex-wrap: wrap;">
                    <a href="#" class="btn btn-primary" onclick="showLogin()">üöÄ Launch CMS Portal</a>
                    <a href="#" class="btn btn-secondary" onclick="showContact()">üìû Contact Support</a>
                </div>
            </div>
            <div class="features">
                <div class="feature-card">
                    <div class="feature-icon">üë•</div>
                    <div class="feature-title">Role-Based Access</div>
                    <div class="feature-desc">Secure login system with different access levels for HOD, HOP, and Content FPR teams.</div>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üìã</div>
                    <div class="feature-title">Request Management</div>
                    <div class="feature-desc">Complete workflow from content request submission to approval and final delivery.</div>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">üìä</div>
                    <div class="feature-title">Real-time Analytics</div>
                    <div class="feature-desc">Comprehensive dashboards with statistics, progress tracking, and performance metrics.</div>
                </div>
            </div>
        </div>
    </div>

    <!-- Login Section -->
    <div class="section" id="loginSection">
        <div class="container">
            <div class="login-container">
                <div style="font-size: 48px; margin-bottom: 20px;">üèõÔ∏è</div>
                <h1 style="color: #2d3748; margin-bottom: 30px; font-size: 28px;">Content Management System</h1>
                <h2 style="color: #666; margin-bottom: 30px; font-size: 18px;">Manipal BFSI</h2>
                <form id="loginForm">
                    <div class="form-group">
                        <label for="username">Username</label>
                        <input type="text" id="username" required placeholder="Enter your username">
                    </div>
                    <div class="form-group">
                        <label for="password">Password</label>
                        <input type="password" id="password" required placeholder="Enter your password">
                    </div>
                    <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 20px;">üîê Login</button>
                </form>
                <div class="message error" id="errorMessage"></div>
                <div class="message success" id="successMessage"></div>
            </div>
        </div>
    </div>

    <!-- HOD Console -->
    <div class="section" id="hodSection">
        <div class="container">
            <div class="header">
                <div>
                    <h1>üìù HOD Console</h1>
                    <div style="font-size: 14px; color: #666;" id="hodUserInfo">Loading...</div>
                </div>
                <button class="btn btn-danger" onclick="logout()">üö™ Logout</button>
            </div>
            <div class="stats">
                <div class="stat-card">
                    <div class="stat-icon">üìã</div>
                    <div class="stat-number" id="hodMyRequests">0</div>
                    <div class="stat-label">My Requests</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">‚è≥</div>
                    <div class="stat-number" id="hodPendingRequests">0</div>
                    <div class="stat-label">Pending</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">‚úÖ</div>
                    <div class="stat-number" id="hodApprovedRequests">0</div>
                    <div class="stat-label">Approved</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üìÖ</div>
                    <div class="stat-number" id="hodThisMonth">0</div>
                    <div class="stat-label">This Month</div>
                </div>
            </div>
            <div class="main-content">
                <div class="form-section">
                    <div class="section-title">üìù Create New Content Request</div>
                    <form id="hodForm">
                        <div class="form-group">
                            <label for="hodRequestId">Request ID</label>
                            <input type="text" id="hodRequestId" readonly placeholder="Auto-generated">
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="hodDepartment">Department <span style="color: #e53e3e;">*</span></label>
                                <select id="hodDepartment" required>
                                    <option value="">Select Department</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="hodProgramType">Program Type <span style="color: #e53e3e;">*</span></label>
                                <select id="hodProgramType" required>
                                    <option value="">Select Program Type</option>
                                    <option value="long-term">Long Term</option>
                                    <option value="short-term">Short Term</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-row">
                            <div class="form-group">
                                <label for="hodRequestType">Request Type <span style="color: #e53e3e;">*</span></label>
                                <select id="hodRequestType" required>
                                    <option value="">Select Request Type</option>
                                    <option value="new-content-request">New Content Request</option>
                                    <option value="content-update">Content Update</option>
                                    <option value="content-review">Content Review</option>
                                </select>
                            </div>
                            <div class="form-group">
                                <label for="hodPriority">Priority <span style="color: #e53e3e;">*</span></label>
                                <select id="hodPriority" required>
                                    <option value="">Select Priority</option>
                                    <option value="high">High</option>
                                    <option value="medium">Medium</option>
                                    <option value="not-urgent">Not Urgent</option>
                                </select>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="hodDeadline">Deadline <span style="color: #e53e3e;">*</span></label>
                            <input type="date" id="hodDeadline" required>
                        </div>
                        <div class="form-group">
                            <label for="hodTitle">Title <span style="color: #e53e3e;">*</span></label>
                            <input type="text" id="hodTitle" required placeholder="Enter brief title">
                        </div>
                        <div class="form-group">
                            <label for="hodDescription">Description <span style="color: #e53e3e;">*</span></label>
                            <textarea id="hodDescription" required placeholder="Detailed description" style="min-height: 100px;"></textarea>
                        </div>
                        <div class="form-group">
                            <label for="hodNotes">Additional Notes</label>
                            <textarea id="hodNotes" placeholder="Any additional notes"></textarea>
                        </div>
                        <div style="display: flex; gap: 15px; margin-top: 30px;">
                            <button type="submit" class="btn btn-primary">üì§ Submit Request</button>
                            <button type="button" class="btn btn-warning" onclick="clearHodForm()">üóëÔ∏è Clear Form</button>
                        </div>
                    </form>
                </div>
                <div class="sidebar-section">
                    <div class="section-title">üìã My Requests</div>
                    <div id="hodRequestsList">
                        <div style="text-align: center; color: #666; padding: 20px;">No requests found</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- HOP Console -->
    <div class="section" id="hopSection">
        <div class="container">
            <div class="header">
                <div>
                    <h1>‚úÖ HOP Console</h1>
                    <div style="font-size: 14px; color: #666;" id="hopUserInfo">Loading...</div>
                </div>
                <button class="btn btn-danger" onclick="logout()">üö™ Logout</button>
            </div>
            <div class="stats">
                <div class="stat-card">
                    <div class="stat-icon">‚è≥</div>
                    <div class="stat-number" id="hopPendingApprovals">0</div>
                    <div class="stat-label">Pending Approvals</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">‚úÖ</div>
                    <div class="stat-number" id="hopApprovedToday">0</div>
                    <div class="stat-label">Approved Today</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">‚ö°</div>
                    <div class="stat-number" id="hopUrgentRequests">0</div>
                    <div class="stat-label">Urgent Requests</div>
                </div>
            </div>
            <div class="main-content">
                <div class="form-section">
                    <div class="section-title">üîç Requests Pending Approval</div>
                    <div id="hopRequestQueue">
                        <div style="text-align: center; color: #666; padding: 40px;">No pending requests</div>
                    </div>
                </div>
                <div class="sidebar-section">
                    <div class="section-title">‚ö° Quick Actions</div>
                    <div style="display: flex; flex-direction: column; gap: 10px;">
                        <button class="btn btn-success" onclick="refreshHopData()">üîÑ Refresh Data</button>
                        <button class="btn btn-warning" onclick="showAllPendingRequests()">üëÅÔ∏è Show All Pending</button>
                        <button class="btn btn-primary" onclick="generateHopReport()">üìä Generate Report</button>
                        <button class="btn btn-success" onclick="forceRefreshData()">üîÑ Force Refresh</button>
                        <button class="btn btn-warning" onclick="syncWithOtherSystem()">üîÑ Sync Systems</button>
                        <button class="btn btn-primary" onclick="debugRequestData()">üîç Debug Data</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Content FPR Console -->
    <div class="section" id="contentSection">
        <div class="container">
            <div class="header">
                <div>
                    <h1>üìä Content FPR Console</h1>
                    <div style="font-size: 14px; color: #666;" id="contentUserInfo">Loading...</div>
                </div>
                <div style="display: flex; gap: 15px;">
                    <button class="btn btn-primary" onclick="toggleAdminPanel()">‚öôÔ∏è Admin Panel</button>
                    <button class="btn btn-danger" onclick="logout()">üö™ Logout</button>
                </div>
            </div>
            <div id="adminPanel" style="display: none;">
                <div class="admin-panel">
                    <div class="section-title">üë• User Management</div>
                    <div class="admin-controls">
                        <div class="control-card" onclick="addUser('HOD')">
                            <div style="font-size: 32px; margin-bottom: 10px;">üë®‚Äçüíº</div>
                            <div>Add HOD User</div>
                        </div>
                        <div class="control-card" onclick="addUser('HOP')">
                            <div style="font-size: 32px; margin-bottom: 10px;">üë©‚Äçüíº</div>
                            <div>Add HOP User</div>
                        </div>
                        <div class="control-card" onclick="addUser('Content')">
                            <div style="font-size: 32px; margin-bottom: 10px;">üìù</div>
                            <div>Add Content FPR</div>
                        </div>
                    </div>
                    <div style="display: flex; gap: 15px; flex-wrap: wrap;">
                        <button class="btn btn-primary" onclick="downloadAllData()">üì• Download All Data</button>
                        <button class="btn btn-warning" onclick="emailMonthlyReport()">üìß Email Report</button>
                        <button class="btn btn-success" onclick="openContactManager()">üîó Manage Contacts</button>
                    </div>
                </div>
            </div>
            <div class="stats">
                <div class="stat-card">
                    <div class="stat-icon">‚è≥</div>
                    <div class="stat-number" id="contentPendingRequests">0</div>
                    <div class="stat-label">Pending Requests</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üî•</div>
                    <div class="stat-number" id="contentUrgentRequests">0</div>
                    <div class="stat-label">Urgent Requests</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">‚úÖ</div>
                    <div class="stat-number" id="contentCompletedToday">0</div>
                    <div class="stat-label">Completed Today</div>
                </div>
            </div>
            <div class="main-content">
                <div class="form-section">
                    <div class="section-title">üìã Requests for Processing</div>
                    <div id="contentRequestQueue">
                        <div style="text-align: center; color: #666; padding: 40px;">No approved requests</div>
                    </div>
                </div>
                <div class="sidebar-section">
                    <div class="section-title">üéØ Quick Actions</div>
                    <div style="display: flex; flex-direction: column; gap: 10px;">
                        <button class="btn btn-primary" onclick="refreshContentData()">üîÑ Refresh Data</button>
                        <button class="btn btn-warning" onclick="showAllRequests()">üëÅÔ∏è Show All</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Contact Section -->
    <div class="section" id="contactSection">
        <div class="container">
            <div class="form-section">
                <div class="section-title">üìû Contact Information</div>
                <div class="contact-list">
                    <div class="contact-item">
                        <div class="contact-info">
                            <div class="contact-name">Freena Lobo</div>
                            <div class="contact-phone">+91 9916422513</div>
                        </div>
                    </div>
                    <div class="contact-item">
                        <div class="contact-info">
                            <div class="contact-name">Sharath Srinivasa</div>
                            <div class="contact-phone">+91 9738411754</div>
                        </div>
                    </div>
                    <div class="contact-item">
                        <div class="contact-info">
                            <div class="contact-name">Mandar Deshpande</div>
                            <div class="contact-phone">+91 9826064826</div>
                        </div>
                    </div>
                </div>
                <div style="margin-top: 30px; text-align: center;">
                    <button class="btn btn-primary" onclick="showLanding()">‚Üê Back to Home</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const users = {
            // HOD users
            'AxisBank_HOD': { password: 'AxisBank@123', role: 'hod', name: 'Axis Bank HOD', department: 'axis-bank' },
            'HDFCBank_HOD': { password: 'HDFCBank@123', role: 'hod', name: 'HDFC Bank HOD', department: 'hdfc-bank' },
            'ICICIBank_HOD': { password: 'ICICIBank@123', role: 'hod', name: 'ICICI Bank HOD', department: 'icici-bank' },
            'KotakBank_HOD': { password: 'KotakBank@123', role: 'hod', name: 'Kotak Bank HOD', department: 'kotak-bank' },
            'IDFCFirstBank_HOD': { password: 'IDFCFirstBank@123', role: 'hod', name: 'IDFC First Bank HOD', department: 'idfc-first-bank' },
            'FederalBank_HOD': { password: 'FederalBank@123', role: 'hod', name: 'Federal Bank HOD', department: 'federal-bank' },
            'TMB_HOD': { password: 'TMB@123', role: 'hod', name: 'TMB HOD', department: 'tmb' },
            'IDBI_HOD': { password: 'IDBI@123', role: 'hod', name: 'IDBI HOD', department: 'idbi' },
            'BOI_HOD': { password: 'BOI@123', role: 'hod', name: 'Bank of India HOD', department: 'boi' },
            'CBI_HOD': { password: 'CBI@123', role: 'hod', name: 'Central Bank of India HOD', department: 'cbi' },
            'BOB_HOD': { password: 'BOB@123', role: 'hod', name: 'Bank of Baroda HOD', department: 'bob' },
            'SBI_HOD': { password: 'SBI@123', role: 'hod', name: 'State Bank of India HOD', department: 'sbi' },
            'PNB_HOD': { password: 'PNB@123', role: 'hod', name: 'Punjab National Bank HOD', department: 'pnb' },
            'Canara_HOD': { password: 'Canara@123', role: 'hod', name: 'Canara Bank HOD', department: 'canara-bank' },
            'UnionBank_HOD': { password: 'UnionBank@123', role: 'hod', name: 'Union Bank HOD', department: 'union-bank' },
            'IOB_HOD': { password: 'IOB@123', role: 'hod', name: 'Indian Overseas Bank HOD', department: 'iob' },
            'Syndicate_HOD': { password: 'Syndicate@123', role: 'hod', name: 'Syndicate Bank HOD', department: 'syndicate-bank' },
            'Corporation_HOD': { password: 'Corporation@123', role: 'hod', name: 'Corporation Bank HOD', department: 'corporation-bank' },
            'Allahabad_HOD': { password: 'Allahabad@123', role: 'hod', name: 'Allahabad Bank HOD', department: 'allahabad-bank' },
            'Andhra_HOD': { password: 'Andhra@123', role: 'hod', name: 'Andhra Bank HOD', department: 'andhra-bank' },
            'OtherPrograms_HOD': { password: 'OtherPrograms@123', role: 'hod', name: 'Other Programs HOD', department: 'other-programs' },
            'Insurance_HOD': { password: 'Insurance@123', role: 'hod', name: 'Insurance Vertical HOD', department: 'insurance-vertical' },
            
            // HOP users
            'AxisBank_HOP': { password: 'AxisBank@123', role: 'hop', name: 'Axis Bank HOP', department: 'axis-bank' },
            'HDFCBank_HOP': { password: 'HDFCBank@123', role: 'hop', name: 'HDFC Bank HOP', department: 'hdfc-bank' },
            'ICICIBank_HOP': { password: 'ICICIBank@123', role: 'hop', name: 'ICICI Bank HOP', department: 'icici-bank' },
            'KotakBank_HOP': { password: 'KotakBank@123', role: 'hop', name: 'Kotak Bank HOP', department: 'kotak-bank' },
            'IDFCFirstBank_HOP': { password: 'IDFCFirstBank@123', role: 'hop', name: 'IDFC First Bank HOP', department: 'idfc-first-bank' },
            'FederalBank_HOP': { password: 'FederalBank@123', role: 'hop', name: 'Federal Bank HOP', department: 'federal-bank' },
            'TMB_HOP': { password: 'TMB@123', role: 'hop', name: 'TMB HOP', department: 'tmb' },
            'IDBI_HOP': { password: 'IDBI@123', role: 'hop', name: 'IDBI HOP', department: 'idbi' },
            'BOI_HOP': { password: 'BOI@123', role: 'hop', name: 'Bank of India HOP', department: 'boi' },
            'CBI_HOP': { password: 'CBI@123', role: 'hop', name: 'Central Bank of India HOP', department: 'cbi' },
            'BOB_HOP': { password: 'BOB@123', role: 'hop', name: 'Bank of Baroda HOP', department: 'bob' },
            'SBI_HOP': { password: 'SBI@123', role: 'hop', name: 'State Bank of India HOP', department: 'sbi' },
            'PNB_HOP': { password: 'PNB@123', role: 'hop', name: 'Punjab National Bank HOP', department: 'pnb' },
            'Canara_HOP': { password: 'Canara@123', role: 'hop', name: 'Canara Bank HOP', department: 'canara-bank' },
            'UnionBank_HOP': { password: 'UnionBank@123', role: 'hop', name: 'Union Bank HOP', department: 'union-bank' },
            'IOB_HOP': { password: 'IOB@123', role: 'hop', name: 'Indian Overseas Bank HOP', department: 'iob' },
            'Syndicate_HOP': { password: 'Syndicate@123', role: 'hop', name: 'Syndicate Bank HOP', department: 'syndicate-bank' },
            'Corporation_HOP': { password: 'Corporation@123', role: 'hop', name: 'Corporation Bank HOP', department: 'corporation-bank' },
            'Allahabad_HOP': { password: 'Allahabad@123', role: 'hop', name: 'Allahabad Bank HOP', department: 'allahabad-bank' },
            'Andhra_HOP': { password: 'Andhra@123', role: 'hop', name: 'Andhra Bank HOP', department: 'andhra-bank' },
            'OtherPrograms_HOP': { password: 'OtherPrograms@123', role: 'hop', name: 'Other Programs HOP', department: 'other-programs' },
            'Insurance_HOP': { password: 'Insurance@123', role: 'hop', name: 'Insurance Vertical HOP', department: 'insurance-vertical' },
            
            // Content FPR users
            'Content_FPR': { password: 'Content@123', role: 'content-fpr', name: 'Content FPR Manager', department: 'content-team' }
        };

        const departments = {
            'axis-bank': { name: 'Axis Bank', prefix: 'AXIS' },
            'hdfc-bank': { name: 'HDFC Bank', prefix: 'HDFC' },
            'icici-bank': { name: 'ICICI Bank', prefix: 'ICICI' },
            'kotak-bank': { name: 'Kotak Bank', prefix: 'KOTAK' },
            'idfc-first-bank': { name: 'IDFC First Bank', prefix: 'IDFC' },
            'federal-bank': { name: 'Federal Bank', prefix: 'FED' },
            'tmb': { name: 'TMB', prefix: 'TMB' },
            'idbi': { name: 'IDBI', prefix: 'IDBI' },
            'boi': { name: 'Bank of India', prefix: 'BOI' },
            'cbi': { name: 'Central Bank of India', prefix: 'CBI' },
            'bob': { name: 'Bank of Baroda', prefix: 'BOB' },
            'sbi': { name: 'State Bank of India', prefix: 'SBI' },
            'pnb': { name: 'Punjab National Bank', prefix: 'PNB' },
            'canara-bank': { name: 'Canara Bank', prefix: 'CANARA' },
            'union-bank': { name: 'Union Bank', prefix: 'UNION' },
            'iob': { name: 'Indian Overseas Bank', prefix: 'IOB' },
            'syndicate-bank': { name: 'Syndicate Bank', prefix: 'SYND' },
            'corporation-bank': { name: 'Corporation Bank', prefix: 'CORP' },
            'allahabad-bank': { name: 'Allahabad Bank', prefix: 'ALLA' },
            'andhra-bank': { name: 'Andhra Bank', prefix: 'ANDHRA' },
            'other-programs': { name: 'Other Programs', prefix: 'OTHER' },
            'insurance-vertical': { name: 'Insurance Vertical', prefix: 'INS' }
        };

        let currentUser = null;
        let allRequests = JSON.parse(localStorage.getItem('cms_requests') || '[]');

        if (allRequests.length === 0) {
            allRequests = [
                {
                    requestId: 'IDBI-2025-0001',
                    department: 'idbi',
                    programType: 'short-term',
                    requestType: 'new-content-request',
                    priority: 'high',
                    deadline: '2025-02-10',
                    title: 'IDBI Content Request',
                    description: 'Short-term content request for IDBI Bank',
                    notes: 'Demo request for testing',
                    submittedBy: 'IDBI_HOD',
                    submittedDate: new Date().toISOString(),
                    status: 'pending',
                    files: []
                },
                {
                    requestId: 'AXIS-2025-0001',
                    department: 'axis-bank',
                    programType: 'long-term',
                    requestType: 'new-content-request',
                    priority: 'medium',
                    deadline: '2025-02-15',
                    title: 'Axis Bank Content',
                    description: 'Long-term program content for Axis Bank',
                    notes: 'Approved demo request',
                    submittedBy: 'AxisBank_HOD',
                    submittedDate: new Date(Date.now() - 86400000).toISOString(),
                    status: 'approved',
                    approvedDate: new Date().toISOString(),
                    approvedBy: 'AxisBank_HOP',
                    files: []
                }
            ];
            localStorage.setItem('cms_requests', JSON.stringify(allRequests));
        }

        function showLanding() {
            hideAllSections();
            document.getElementById('landingSection').classList.add('active');
            updateNavigation('home');
        }

        function showLogin() {
            hideAllSections();
            document.getElementById('loginSection').classList.add('active');
            updateNavigation('cms');
        }

        function showContact() {
            hideAllSections();
            document.getElementById('contactSection').classList.add('active');
        }

        function hideAllSections() {
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
            });
        }

        function updateNavigation(activeItem) {
            document.querySelectorAll('.nav-links a').forEach(link => {
                link.classList.remove('active');
            });
            if (document.getElementById(`nav-${activeItem}`)) {
                document.getElementById(`nav-${activeItem}`).classList.add('active');
            }
        }

        function showMessage(message, isError = false) {
            const errorDiv = document.getElementById('errorMessage');
            const successDiv = document.getElementById('successMessage');
            
            if (isError) {
                errorDiv.textContent = message;
                errorDiv.style.display = 'block';
                if (successDiv) successDiv.style.display = 'none';
            } else {
                successDiv.textContent = message;
                successDiv.style.display = 'block';
                if (errorDiv) errorDiv.style.display = 'none';
            }
            
            setTimeout(() => {
                if (errorDiv) errorDiv.style.display = 'none';
                if (successDiv) successDiv.style.display = 'none';
            }, 5000);
        }

        function authenticateUser(username, password) {
            const user = users[username];
            if (!user) return { success: false, message: 'Invalid username' };
            if (user.password !== password) return { success: false, message: 'Invalid password' };
            return { success: true, user: user };
        }

        function logout() {
            currentUser = null;
            showLanding();
        }

        // Login form handler
        document.getElementById('loginForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value;
            
            if (!username || !password) {
                showMessage('Please fill in all fields', true);
                return;
            }
            
            const result = authenticateUser(username, password);
            
            if (result.success) {
                currentUser = result.user;
                currentUser.username = username;
                showMessage(`Welcome ${result.user.name}! Loading your console...`);
                
                setTimeout(() => {
                    switch(result.user.role) {
                        case 'hod':
                            initializeHodConsole();
                            hideAllSections();
                            document.getElementById('hodSection').classList.add('active');
                            break;
                        case 'hop':
                            initializeHopConsole();
                            hideAllSections();
                            document.getElementById('hopSection').classList.add('active');
                            break;
                        case 'content-fpr':
                            initializeContentConsole();
                            hideAllSections();
                            document.getElementById('contentSection').classList.add('active');
                            break;
                    }
                }, 1500);
            } else {
                showMessage(result.message, true);
            }
        });

        // HOD Console Functions
        function initializeHodConsole() {
            document.getElementById('hodUserInfo').textContent = 
                `Welcome ${currentUser.name} | Department: ${departments[currentUser.department].name}`;
            
            setupHodDepartment();
            loadHodStats();
            loadHodRequests();
        }

        function setupHodDepartment() {
            const departmentSelect = document.getElementById('hodDepartment');
            const userDept = currentUser.department;
            const deptInfo = departments[userDept];
            
            departmentSelect.innerHTML = `<option value="${userDept}">${deptInfo.name}</option>`;
            departmentSelect.value = userDept;
            
            generateHodRequestId();
            departmentSelect.addEventListener('change', generateHodRequestId);
        }

        function generateHodRequestId() {
            const department = document.getElementById('hodDepartment').value;
            if (!department) return;
            
            const prefix = departments[department].prefix;
            const year = new Date().getFullYear();
            const nextNumber = getNextRequestNumber(department);
            const requestId = `${prefix}-${year}-${String(nextNumber).padStart(4, '0')}`;
            
            document.getElementById('hodRequestId').value = requestId;
        }

        function getNextRequestNumber(department) {
            const prefix = departments[department].prefix;
            const year = new Date().getFullYear();
            const existingRequests = allRequests.filter(req => 
                req.requestId.startsWith(`${prefix}-${year}`)
            );
            return existingRequests.length + 1;
        }

        function loadHodStats() {
            const userRequests = allRequests.filter(req => req.submittedBy === currentUser.username);
            const pendingRequests = userRequests.filter(req => req.status === 'pending');
            const approvedRequests = userRequests.filter(req => req.status === 'approved');
            const thisMonth = userRequests.filter(req => {
                const reqDate = new Date(req.submittedDate);
                const now = new Date();
                return reqDate.getMonth() === now.getMonth() && reqDate.getFullYear() === now.getFullYear();
            });

            document.getElementById('hodMyRequests').textContent = userRequests.length;
            document.getElementById('hodPendingRequests').textContent = pendingRequests.length;
            document.getElementById('hodApprovedRequests').textContent = approvedRequests.length;
            document.getElementById('hodThisMonth').textContent = thisMonth.length;
        }

        function loadHodRequests() {
            const userRequests = allRequests.filter(req => req.submittedBy === currentUser.username);
            const requestsList = document.getElementById('hodRequestsList');
            
            if (userRequests.length === 0) {
                requestsList.innerHTML = '<div style="text-align: center; color: #666; padding: 20px;">No requests found</div>';
                return;
            }

            requestsList.innerHTML = userRequests.map(req => `
                <div class="request-card">
                    <div class="request-header">
                        <span class="request-id">${req.requestId}</span>
                        <span class="status-badge status-${req.status}">${req.status}</span>
                    </div>
                    <div style="font-size: 14px; color: #666; margin-bottom: 10px;">
                        ${req.title} - ${req.priority} Priority<br>
                        Submitted: ${new Date(req.submittedDate).toLocaleDateString()}
                    </div>
                    <div style="display: flex; gap: 8px;">
                        <button class="btn btn-primary btn-small" onclick="viewRequest('${req.requestId}')">View</button>
                    </div>
                </div>
            `).join('');
        }

        function clearHodForm() {
            document.getElementById('hodForm').reset();
            setupHodDepartment();
        }

        // HOD Form submission
        document.getElementById('hodForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const requestId = document.getElementById('hodRequestId').value;
            const department = document.getElementById('hodDepartment').value;
            const programType = document.getElementById('hodProgramType').value;
            const requestType = document.getElementById('hodRequestType').value;
            const priority = document.getElementById('hodPriority').value;
            const deadline = document.getElementById('hodDeadline').value;
            const title = document.getElementById('hodTitle').value;
            const description = document.getElementById('hodDescription').value;
            const notes = document.getElementById('hodNotes').value;
            
            if (!requestId || !department || !programType || !requestType || !priority || !deadline || !title || !description) {
                alert('Please fill in all required fields');
                return;
            }

            const request = {
                requestId: requestId,
                department: department,
                programType: programType,
                requestType: requestType,
                priority: priority,
                deadline: deadline,
                title: title,
                description: description,
                notes: notes,
                submittedBy: currentUser.username,
                submittedDate: new Date().toISOString(),
                status: 'pending',
                files: []
            };

            allRequests.push(request);
            localStorage.setItem('cms_requests', JSON.stringify(allRequests));
            
            // Send email notification to HOP
            sendEmailNotification(request, 'submitted');
            
            // Show success message with email notification
            showSuccessMessage('Request Submitted Successfully!', 
                `‚úÖ Request ${requestId} submitted and email notification sent to HOP team for approval.`);
            
            clearHodForm();
            loadHodStats();
            loadHodRequests();
        });

        // HOP Console Functions
        function initializeHopConsole() {
            document.getElementById('hopUserInfo').textContent = 
                `Welcome ${currentUser.name} | Department: ${departments[currentUser.department].name}`;
            
            loadHopStats();
            loadHopRequests();
        }

        function loadHopStats() {
            const deptRequests = allRequests.filter(req => 
                req.department === currentUser.department && req.status === 'pending'
            );
            const approvedToday = allRequests.filter(req => {
                const today = new Date().toDateString();
                return req.department === currentUser.department && 
                       req.status === 'approved' && 
                       new Date(req.approvedDate || '').toDateString() === today;
            });
            const urgentRequests = deptRequests.filter(req => req.priority === 'high');

            document.getElementById('hopPendingApprovals').textContent = deptRequests.length;
            document.getElementById('hopApprovedToday').textContent = approvedToday.length;
            document.getElementById('hopUrgentRequests').textContent = urgentRequests.length;
        }

        function loadHopRequests() {
            const deptRequests = allRequests.filter(req => 
                req.department === currentUser.department && req.status === 'pending'
            );
            const requestQueue = document.getElementById('hopRequestQueue');
            
            // Debug information
            console.log('Current User Department:', currentUser.department);
            console.log('All Requests:', allRequests);
            console.log('Filtered Requests for this department:', deptRequests);
            
            if (deptRequests.length === 0) {
                // Show more detailed no-requests message with debug info
                const allDeptRequests = allRequests.filter(req => req.department === currentUser.department);
                const pendingInSystem = allRequests.filter(req => req.status === 'pending');
                
                requestQueue.innerHTML = `
                    <div style="text-align: center; color: #666; padding: 40px;">
                        <div style="font-size: 48px; margin-bottom: 20px;">üì≠</div>
                        <div style="font-size: 18px; margin-bottom: 15px;">No pending requests for ${departments[currentUser.department]?.name || currentUser.department}</div>
                        <div style="font-size: 14px; color: #999; margin-bottom: 20px;">
                            Total requests for your department: ${allDeptRequests.length}<br>
                            Pending requests in system: ${pendingInSystem.length}<br>
                            Your department ID: ${currentUser.department}
                        </div>
                        <div style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
                            <button class="btn btn-primary" onclick="refreshHopData()">üîÑ Refresh Data</button>
                            <button class="btn btn-warning" onclick="showAllPendingRequests()">üëÅÔ∏è Show All Pending</button>
                            <button class="btn btn-success" onclick="debugRequestData()">üîç Debug Data</button>
                        </div>
                    </div>
                `;
                return;
            }

            requestQueue.innerHTML = deptRequests.map(req => `
                <div class="request-card ${req.priority === 'high' ? 'urgent' : ''}">
                    <div class="request-header">
                        <span class="request-id">${req.requestId}</span>
                        <span class="priority-badge priority-${req.priority === 'not-urgent' ? 'low' : req.priority}">
                            ${req.priority === 'not-urgent' ? 'Not Urgent' : req.priority}
                        </span>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                        <div><strong>Type:</strong> ${req.requestType}</div>
                        <div><strong>Program:</strong> ${req.programType}</div>
                        <div><strong>Deadline:</strong> ${new Date(req.deadline).toLocaleDateString()}</div>
                        <div><strong>Submitted:</strong> ${new Date(req.submittedDate).toLocaleDateString()}</div>
                    </div>

                    <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #ed8936;">
                        <strong>Title:</strong> ${req.title}<br>
                        <strong>Description:</strong> ${req.description}<br>
                        <strong>Submitted by:</strong> ${req.submittedBy}<br>
                        <strong>Department:</strong> ${req.department}
                    </div>

                    <div style="display: flex; gap: 10px; justify-content: flex-end;">
                        <button class="btn btn-success btn-small" onclick="approveRequest('${req.requestId}')">Approve</button>
                        <button class="btn btn-danger btn-small" onclick="rejectRequest('${req.requestId}')">Reject</button>
                    </div>
                </div>
            `).join('');
        }

        function showAllPendingRequests() {
            const allPending = allRequests.filter(req => req.status === 'pending');
            const requestQueue = document.getElementById('hopRequestQueue');
            
            if (allPending.length === 0) {
                requestQueue.innerHTML = `
                    <div style="text-align: center; color: #666; padding: 40px;">
                        <div style="font-size: 18px; margin-bottom: 15px;">No pending requests in entire system</div>
                        <button class="btn btn-primary" onclick="loadHopRequests()">üîô Back to My Requests</button>
                    </div>
                `;
                return;
            }

            requestQueue.innerHTML = `
                <div style="background: #fef5e7; padding: 15px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid #ed8936;">
                    <strong>üîç Showing ALL pending requests in system (${allPending.length} total)</strong><br>
                    <button class="btn btn-primary btn-small" onclick="loadHopRequests()" style="margin-top: 10px;">üîô Back to My Department</button>
                </div>
            ` + allPending.map(req => `
                <div class="request-card ${req.priority === 'high' ? 'urgent' : ''}" style="opacity: ${req.department === currentUser.department ? '1' : '0.6'};">
                    <div class="request-header">
                        <span class="request-id">${req.requestId}</span>
                        <span class="priority-badge priority-${req.priority === 'not-urgent' ? 'low' : req.priority}">
                            ${req.priority === 'not-urgent' ? 'Not Urgent' : req.priority}
                        </span>
                        ${req.department !== currentUser.department ? '<span style="background: #fed7d7; color: #c53030; padding: 2px 8px; border-radius: 8px; font-size: 10px;">OTHER DEPT</span>' : ''}
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                        <div><strong>Department:</strong> ${departments[req.department]?.name || req.department}</div>
                        <div><strong>Type:</strong> ${req.requestType}</div>
                        <div><strong>Program:</strong> ${req.programType}</div>
                        <div><strong>Submitted:</strong> ${new Date(req.submittedDate).toLocaleDateString()}</div>
                    </div>

                    <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #ed8936;">
                        <strong>Title:</strong> ${req.title}<br>
                        <strong>Description:</strong> ${req.description}<br>
                        <strong>Submitted by:</strong> ${req.submittedBy}
                    </div>

                    ${req.department === currentUser.department ? `
                        <div style="display: flex; gap: 10px; justify-content: flex-end;">
                            <button class="btn btn-success btn-small" onclick="approveRequest('${req.requestId}')">Approve</button>
                            <button class="btn btn-danger btn-small" onclick="rejectRequest('${req.requestId}')">Reject</button>
                        </div>
                    ` : `
                        <div style="text-align: center; color: #666; font-style: italic;">
                            This request belongs to another department
                        </div>
                    `}
                </div>
            `).join('');
        }

        function debugRequestData() {
            const allPending = allRequests.filter(req => req.status === 'pending');
            const myDeptRequests = allRequests.filter(req => req.department === currentUser.department);
            const insuranceRequests = allRequests.filter(req => req.department === 'insurance-vertical');
            
            const debugInfo = `
üîç DEBUG INFORMATION:

üë§ Current User: ${currentUser.name}
üè¢ Department: ${currentUser.department}
üìä Department Name: ${departments[currentUser.department]?.name || 'Unknown'}

üìã REQUEST STATISTICS:
‚Ä¢ Total requests in system: ${allRequests.length}
‚Ä¢ Pending requests: ${allPending.length}
‚Ä¢ My department requests: ${myDeptRequests.length}
‚Ä¢ Insurance vertical requests: ${insuranceRequests.length}

üéØ PENDING REQUESTS BY DEPARTMENT:
${allPending.map(req => `‚Ä¢ ${req.requestId} - ${departments[req.department]?.name || req.department} (${req.status})`).join('\n')}

üîë INSURANCE REQUESTS:
${insuranceRequests.map(req => `‚Ä¢ ${req.requestId} - Status: ${req.status} - Submitted: ${new Date(req.submittedDate).toLocaleDateString()}`).join('\n')}

üìù RECENT ACTIVITY:
${allRequests.slice(-5).map(req => `‚Ä¢ ${req.requestId} - ${req.status} - ${new Date(req.submittedDate).toLocaleDateString()}`).join('\n')}
            `;
            
            alert(debugInfo);
        }

        function forceRefreshData() {
            // Force reload from localStorage
            allRequests = JSON.parse(localStorage.getItem('cms_requests') || '[]');
            loadHopStats();
            loadHopRequests();
            
            showSuccessMessage('Data Force Refreshed!', 
                `‚úÖ All data reloaded from storage. Found ${allRequests.length} total requests.`);
        }

        function syncWithOtherSystem() {
            // Simulate syncing with another system
            const confirmSync = confirm('This will attempt to sync data with other systems. Continue?');
            if (confirmSync) {
                // Add any missing insurance requests for testing
                const hasInsuranceRequest = allRequests.some(req => 
                    req.department === 'insurance-vertical' && req.status === 'pending'
                );
                
                if (!hasInsuranceRequest) {
                    const testInsuranceRequest = {
                        requestId: 'INS-2025-0001',
                        department: 'insurance-vertical',
                        programType: 'short-term',
                        requestType: 'new-content-request',
                        priority: 'high',
                        deadline: '2025-02-15',
                        title: 'Insurance Vertical Content Request',
                        description: 'Content request for insurance vertical programs',
                        notes: 'Synced from other system',
                        submittedBy: 'Insurance_HOD',
                        submittedDate: new Date().toISOString(),
                        status: 'pending',
                        files: []
                    };
                    
                    allRequests.push(testInsuranceRequest);
                    localStorage.setItem('cms_requests', JSON.stringify(allRequests));
                    
                    showSuccessMessage('Sync Completed!', 
                        `‚úÖ Found and synced Insurance request: ${testInsuranceRequest.requestId}`);
                } else {
                    showSuccessMessage('Sync Completed!', 
                        `‚úÖ No new requests found to sync.`);
                }
                
                loadHopStats();
                loadHopRequests();
            }
        }

        function approveRequest(requestId) {
            const request = allRequests.find(req => req.requestId === requestId);
            if (request) {
                request.status = 'approved';
                request.approvedDate = new Date().toISOString();
                request.approvedBy = currentUser.username;
                
                localStorage.setItem('cms_requests', JSON.stringify(allRequests));
                
                alert(`Request ${requestId} approved successfully! Content FPR team has been notified.`);
                loadHopStats();
                loadHopRequests();
            }
        }

        function rejectRequest(requestId) {
            const reason = prompt('Please provide a reason for rejection:');
            if (reason) {
                const request = allRequests.find(req => req.requestId === requestId);
                if (request) {
                    request.status = 'rejected';
                    request.rejectionReason = reason;
                    request.rejectedBy = currentUser.username;
                    request.rejectedDate = new Date().toISOString();
                    
                    localStorage.setItem('cms_requests', JSON.stringify(allRequests));
                    
                    alert(`Request ${requestId} rejected successfully!`);
                    loadHopStats();
                    loadHopRequests();
                }
            }
        }

        function refreshHopData() {
            loadHopStats();
            loadHopRequests();
            alert('Data refreshed successfully!');
        }

        function generateHopReport() {
            alert('HOP report generation feature would be implemented here.');
        }

        // Content FPR Console Functions
        function initializeContentConsole() {
            document.getElementById('contentUserInfo').textContent = 
                `Welcome ${currentUser.name} | Content Team`;
            
            loadContentStats();
            loadContentRequests();
        }

        function loadContentStats() {
            const approvedRequests = allRequests.filter(req => req.status === 'approved');
            const urgentRequests = approvedRequests.filter(req => req.priority === 'high');
            const completedToday = allRequests.filter(req => {
                const today = new Date().toDateString();
                return req.status === 'completed' && 
                       new Date(req.completedDate || '').toDateString() === today;
            });

            document.getElementById('contentPendingRequests').textContent = approvedRequests.length;
            document.getElementById('contentUrgentRequests').textContent = urgentRequests.length;
            document.getElementById('contentCompletedToday').textContent = completedToday.length;
        }

        function loadContentRequests() {
            const approvedRequests = allRequests.filter(req => req.status === 'approved');
            const requestQueue = document.getElementById('contentRequestQueue');
            
            if (approvedRequests.length === 0) {
                requestQueue.innerHTML = `
                    <div style="text-align: center; color: #666; padding: 40px;">
                        <div style="font-size: 18px; margin-bottom: 15px;">No approved requests found</div>
                        <button class="btn btn-primary" onclick="refreshContentData()">üîÑ Refresh Data</button>
                    </div>
                `;
                return;
            }

            requestQueue.innerHTML = approvedRequests.map(req => `
                <div class="request-card ${req.priority === 'high' ? 'urgent' : ''}">
                    <div class="request-header">
                        <span class="request-id">${req.requestId}</span>
                        <span class="priority-badge priority-${req.priority === 'not-urgent' ? 'low' : req.priority}">
                            ${req.priority === 'not-urgent' ? 'Not Urgent' : req.priority}
                        </span>
                    </div>
                    
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                        <div><strong>Department:</strong> ${departments[req.department] ? departments[req.department].name : req.department}</div>
                        <div><strong>Type:</strong> ${req.requestType}</div>
                        <div><strong>Deadline:</strong> ${new Date(req.deadline).toLocaleDateString()}</div>
                        <div><strong>Approved:</strong> ${req.approvedDate ? new Date(req.approvedDate).toLocaleDateString() : 'Recently'}</div>
                    </div>

                    <div style="background: white; padding: 15px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #48bb78;">
                        <strong>Title:</strong> ${req.title}<br>
                        <strong>Description:</strong> ${req.description}
                    </div>

                    <div style="display: flex; gap: 10px; justify-content: flex-end;">
                        <button class="btn btn-success btn-small" onclick="markRequestCompleted('${req.requestId}')">Mark Completed</button>
                        <button class="btn btn-primary btn-small" onclick="downloadRequestExcel('${req.requestId}')">Download Excel</button>
                    </div>
                </div>
            `).join('');
        }

        function markRequestCompleted(requestId) {
            const request = allRequests.find(req => req.requestId === requestId);
            if (request) {
                request.status = 'completed';
                request.completedDate = new Date().toISOString();
                request.completedBy = currentUser.username;
                
                localStorage.setItem('cms_requests', JSON.stringify(allRequests));
                
                alert(`Request ${requestId} marked as completed successfully!`);
                loadContentStats();
                loadContentRequests();
            }
        }

        function downloadRequestExcel(requestId) {
            const request = allRequests.find(req => req.requestId === requestId);
            if (request) {
                const csvData = `Request ID,Department,Title,Type,Priority,Status,Submitted Date,Deadline,Description
${request.requestId},"${departments[request.department] ? departments[request.department].name : request.department}","${request.title}","${request.requestType}","${request.priority}","${request.status}","${new Date(request.submittedDate).toLocaleDateString()}","${new Date(request.deadline).toLocaleDateString()}","${request.description}"`;

                const blob = new Blob([csvData], { type: 'text/csv' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = url;
                a.download = `${request.requestId}_details.csv`;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
            }
        }

        function refreshContentData() {
            loadContentStats();
            loadContentRequests();
            alert('Data refreshed successfully!');
        }

        function showAllRequests() {
            alert('Show all requests feature would display a comprehensive view of all requests across departments.');
        }

        function toggleAdminPanel() {
            const panel = document.getElementById('adminPanel');
            panel.style.display = panel.style.display === 'none' ? 'block' : 'none';
        }

        function addUser(type) {
            alert(`Add ${type} user functionality would be implemented here with proper form validation and database integration.`);
        }

        function downloadAllData() {
            const csvData = `Request ID,Department,Title,Type,Priority,Status,Submitted By,Submitted Date,Deadline,Description
${allRequests.map(req => 
                `${req.requestId},"${departments[req.department] ? departments[req.department].name : req.department}","${req.title}","${req.requestType}","${req.priority}","${req.status}","${req.submittedBy}","${new Date(req.submittedDate).toLocaleDateString()}","${new Date(req.deadline).toLocaleDateString()}","${req.description}"`
            ).join('\n')}`;

            const blob = new Blob([csvData], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.style.display = 'none';
            a.href = url;
            a.download = `cms_all_requests_${new Date().toISOString().split('T')[0]}.csv`;
            document.body.appendChild(a);
            a.click();
            window.URL.revokeObjectURL(url);
        }

        function emailMonthlyReport() {
            const thisMonth = allRequests.filter(req => {
                const reqDate = new Date(req.submittedDate);
                const now = new Date();
                return reqDate.getMonth() === now.getMonth() && reqDate.getFullYear() === now.getFullYear();
            });

            const subject = `CMS Monthly Report - ${new Date().toLocaleDateString('en-US', { month: 'long', year: 'numeric' })}`;
            const body = `Monthly CMS Report

Total Requests This Month: ${thisMonth.length}
Pending: ${thisMonth.filter(r => r.status === 'pending').length}
Approved: ${thisMonth.filter(r => r.status === 'approved').length}
Completed: ${thisMonth.filter(r => r.status === 'completed').length}

Best regards,
CMS System`;

            const mailtoLink = `mailto:?subject=${encodeURIComponent(subject)}&body=${encodeURIComponent(body)}`;
            window.open(mailtoLink);
        }

        function openContactManager() {
            alert('Contact manager would open here for managing system contacts and notifications.');
        }

        function viewRequest(requestId) {
            const request = allRequests.find(req => req.requestId === requestId);
            if (request) {
                alert(`Request Details:
ID: ${request.requestId}
Title: ${request.title}
Status: ${request.status}
Priority: ${request.priority}
Deadline: ${new Date(request.deadline).toLocaleDateString()}
Description: ${request.description}`);
            }
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            showLanding();
        });
    </script>
</body>
</html>
